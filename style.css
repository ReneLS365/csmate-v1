:root{
  --bg:#1e1f22;
  --elev:#26272b;
  --panel:#2d2f34;
  --text:#f4f4f6;
  --muted:#c8c9ce;
  --border:#3b3d45;
  --accent:#8ea0b5;
  --gap:12px;
  --pad:12px;
}
*{box-sizing:border-box}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
header{position:sticky;top:0;background:var(--elev);border-bottom:1px solid var(--border);z-index:5}
header .bar{display:flex;gap:8px;align-items:center;justify-content:space-between;padding:10px var(--pad)}
header .ttl{font-weight:700}
nav{display:flex;gap:8px;flex-wrap:wrap}
nav button{background:#34353b;color:var(--text);border:1px solid var(--border);border-radius:12px;padding:12px 16px;min-height:44px}
nav button.active{outline:2px solid var(--accent)}
main{padding:var(--pad);display:flex;flex-direction:column;gap:var(--gap)}
fieldset{border:1px solid var(--border);background:var(--panel);border-radius:12px;margin:0;padding:var(--pad)}
legend{color:var(--muted);padding:0 6px}
label{display:flex;flex-direction:column;gap:6px;font-size:0.95rem}
label span{color:var(--muted);font-size:0.85rem}
.status-bar{display:flex;gap:16px;flex-wrap:wrap;align-items:flex-end;margin-bottom:var(--gap)}
.status-select{min-width:220px}
.status-indicator{display:flex;flex-direction:column;gap:6px;min-width:180px}
.status-indicator span{color:var(--muted);font-size:0.85rem}
.status-pill{display:inline-flex;align-items:center;justify-content:center;padding:8px 14px;border-radius:999px;border:1px solid var(--border);background:rgba(255,255,255,0.05);text-transform:capitalize;font-weight:600;min-width:140px;text-align:center}
.status-pill[data-status="afventer"]{background:rgba(255,196,38,0.12);color:#ffd66c;border-color:rgba(255,196,38,0.4)}
.status-pill[data-status="godkendt"]{background:rgba(93,201,133,0.18);color:#8adbae;border-color:rgba(93,201,133,0.4)}
.status-pill[data-status="afvist"]{background:rgba(214,102,102,0.18);color:#ff9b9b;border-color:rgba(214,102,102,0.4)}
.form-actions{margin-top:var(--gap);display:flex;justify-content:flex-end}
.form-actions button{min-width:160px}
.date-field .date-input-wrapper{display:flex;align-items:center;gap:8px}
.date-field .date-input-wrapper input[type=date]{flex:1}
.date-picker-trigger{display:inline-flex;align-items:center;justify-content:center;min-height:44px;min-width:44px;padding:0 12px;font-size:1.25rem;line-height:1;border:1px solid var(--border);background:var(--elev)}
.date-picker-trigger:focus-visible{outline:2px solid var(--accent);outline-offset:2px}
input,select,textarea,button{background:var(--panel);color:var(--text);border:1px solid var(--border);border-radius:10px;min-height:44px;padding:10px;font-size:16px}
textarea{resize:vertical}
button{cursor:pointer}
.sektion{display:flex;flex-direction:column;gap:var(--gap)}
.sektion.active{display:flex!important;}
.row{display:flex;gap:8px;flex-wrap:wrap}
.btn-group{display:flex;gap:8px;flex-wrap:wrap}
.grid-3{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:var(--gap)}
.grid-2{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:var(--gap)}
.form-grid{padding:var(--pad);background:var(--panel);border-radius:12px}
.col-span-3{grid-column:1/-1}
.materials{max-height:60vh;overflow:auto;display:flex;flex-direction:column;gap:8px;width:100%}
.material-row{display:grid;grid-template-columns:minmax(200px,2fr) repeat(2,minmax(0,1fr)) minmax(120px,1fr);gap:10px;align-items:center;background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:12px}
.material-row.manual input[type="text"]{min-width:160px}
.material-row strong{justify-self:end}
.material-row label{font-size:0.85rem}
.material-row .cell-label{color:var(--muted);font-size:0.8rem}
.material-row .item-name{font-weight:600}
.material-row .item-name-wrapper{display:flex;flex-direction:column;gap:6px}
.material-row .item-id{color:var(--muted);font-size:0.75rem;letter-spacing:0.01em}
.manual-name-cell{display:flex;flex-direction:column;gap:6px}
.manual-name-cell .item-id{font-size:0.75rem;color:var(--muted)}
.material-row .item-total{justify-self:end}
.material-row .system-badge{display:inline-flex;align-items:center;justify-content:center;margin-left:8px;padding:2px 8px;border-radius:999px;border:1px solid var(--border);background:rgba(142,160,181,0.15);color:var(--accent);font-size:0.7rem;letter-spacing:0.02em;text-transform:uppercase}
.empty-state{margin:0;padding:16px;border:1px dashed var(--border);border-radius:12px;text-align:center;color:var(--muted);background:rgba(255,255,255,0.03)}
.overview{background:var(--elev);border:1px solid var(--border);border-radius:12px;padding:var(--pad)}
.totals{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:var(--gap)}
.totals div{display:flex;flex-direction:column;gap:4px;background:var(--panel);border:1px solid var(--border);border-radius:10px;padding:12px}
.totals span{color:var(--muted);font-size:0.85rem}
.totals strong{font-size:1.25rem}
.import-zone{background:var(--panel);border:1px dashed var(--border);border-radius:12px;padding:var(--pad)}
.drop-area{border:2px dashed #aaa;border-radius:8px;padding:24px;text-align:center;display:flex;flex-direction:column;gap:6px;justify-content:center;align-items:center;min-height:140px;transition:all .2s ease}
.drop-area.dragover{border-color:#333;background:rgba(255,255,255,0.05)}
.recent-cases{margin-top:var(--gap);display:flex;gap:8px;flex-wrap:wrap}
.recent-cases select{flex:1 1 200px;min-width:200px}
.recent-cases button{flex:0 0 auto;min-width:140px}
.hint{font-size:0.9rem;color:var(--muted);margin:0}
.hint.error{color:#ff9b9b}
.hint.success{color:#8adbae}
.invalid{border-color:#d66;background:rgba(214,102,102,0.15)}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
.overview-inline{background:transparent;border:none;padding:0}
.overview-inline .totals div{background:var(--elev)}
.worker-row{display:flex;flex-direction:column;gap:12px}
.extra-work-grid{grid-template-columns:repeat(auto-fit,minmax(180px,1fr))}
.worker-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:var(--gap)}
.worker-grid label{display:flex;flex-direction:column;gap:6px}
.worker-grid span{color:var(--muted);font-size:0.85rem}
.worker-output{min-height:24px;font-size:0.95rem;color:var(--accent)}
.system-selector{display:flex;flex-direction:column;gap:10px}
.system-selector-options{display:flex;flex-wrap:wrap;gap:10px}
.system-option{display:inline-flex;align-items:center;gap:10px;padding:10px 14px;border:1px solid var(--border);border-radius:12px;background:rgba(255,255,255,0.04);min-height:44px;transition:border-color .2s ease,background .2s ease}
.system-option input{width:18px;height:18px}
.system-option:hover{border-color:var(--accent);background:rgba(142,160,181,0.12)}
.system-warning{margin-top:6px}
.status-message{margin:6px 0 0;font-size:0.85rem}
.status-message.success{color:#8adbae}
.status-message.error{color:#ff9b9b}
.ekomplet-actions{margin-top:16px;display:flex;flex-direction:column;gap:10px}
.ekomplet-actions button{align-self:flex-start}
.modal{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;padding:24px;z-index:999}
.modal.open{display:flex}
.modal[hidden]{display:none!important}
.modal-content{position:relative;background:var(--panel);border-radius:16px;border:1px solid var(--border);padding:24px;max-width:min(640px,90vw);width:100%;max-height:90vh;overflow:auto;box-shadow:0 20px 50px rgba(0,0,0,0.4);outline:none}
.modal-content h2{margin-top:0}
.modal-content ol{padding-left:22px;line-height:1.6}
.modal-content p{line-height:1.6}
.modal-close{position:absolute;top:16px;right:16px;width:36px;height:36px;border-radius:50%;border:1px solid var(--border);background:#3a3c43;color:var(--text);font-size:1.5rem;line-height:1;display:flex;align-items:center;justify-content:center;cursor:pointer}
.keypad-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:flex-end;justify-content:center;z-index:9999;padding:0 12px 12px;padding:0 12px calc(12px + env(safe-area-inset-bottom))}
.keypad-overlay.show{display:flex}
.keypad{width:min(100%,440px);background:var(--panel);border:1px solid var(--border);border-radius:20px 20px 0 0;padding:18px 18px 14px;display:flex;flex-direction:column;gap:14px;box-shadow:0 -8px 28px rgba(0,0,0,0.35)}
.keypad[aria-hidden="true"]{display:none}
.keypad-display{font-size:clamp(1.45rem,4vw,1.8rem);text-align:right;padding:14px;border:1px dashed var(--border);border-radius:14px;min-height:54px;letter-spacing:1px}
.keypad-grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:10px}
.keypad-grid button{min-height:64px;border-radius:16px;background:#3a3c43;border:1px solid var(--border);font-size:clamp(1.3rem,5vw,1.6rem);font-weight:600;touch-action:manipulation}
.keypad-grid button[data-action="backspace"]{font-size:clamp(1.4rem,5.5vw,1.8rem)}
.keypad-quick{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:8px}
.keypad-quick button{min-height:46px;border-radius:14px;background:#393b43;border:1px solid var(--border);font-size:1.05rem;font-weight:600;touch-action:manipulation}
.keypad-quick button[data-delta^="-"]{background:#3a2f34}
.keypad-quick button[data-delta^="+"]{background:#32423a}
.keypad-actions{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
.keypad-actions button{min-height:56px;border-radius:14px;background:#3a3c43;border:1px solid var(--border);font-size:1.1rem;font-weight:700;touch-action:manipulation}
.keypad-actions button[data-action="ok"]{background:var(--accent);color:#111}
.keypad-close{min-height:48px;border-radius:14px;border:1px solid var(--border);background:#3a3c43;font-size:1rem;font-weight:600;touch-action:manipulation}
@media (max-width:900px){
  .material-row{grid-template-columns:minmax(160px,2fr) minmax(0,1fr) minmax(0,1fr);grid-auto-rows:auto}
  .material-row .item-total{grid-column:1/-1}
}
@media (max-width:600px){
  header .bar{flex-direction:column;align-items:flex-start}
  .grid-3{grid-template-columns:1fr}
  .grid-2{grid-template-columns:1fr}
  .worker-grid{grid-template-columns:1fr}
  .totals{grid-template-columns:1fr}
  .recent-cases{flex-direction:column}
  .recent-cases button{width:100%}
  .status-bar{flex-direction:column;align-items:flex-start}
  .status-pill{min-width:0;width:100%;justify-content:flex-start;padding-inline:12px}
  .material-row{
    grid-template-columns:minmax(140px,1.6fr) repeat(3,minmax(0,1fr));
    grid-auto-rows:auto;
    gap:8px;
  }
  .material-row .item-total{grid-column:auto}
  .material-row .item-name-wrapper{min-width:0}
  .material-row.manual input[type="text"]{min-width:0}
  .material-row input,
  .material-row select,
  .material-row textarea{
    min-width:0;
    padding:8px 10px;
    font-size:0.95rem;
  }
  .btn-group{flex-direction:column}
  nav button{padding:10px 12px}
  .materials{max-height:65vh;overflow:auto;padding-right:4px}
  .system-selector-options{gap:8px}
  .system-option{flex:1 1 calc(50% - 8px);justify-content:flex-start}
}
@media (max-width:480px){
  body{font-size:15px}
  nav button{flex:1 1 auto;width:100%}
  .material-row{padding:10px}
  .material-row label{font-size:0.9rem}
  .material-row .system-badge{margin-left:6px;font-size:0.65rem}
  .system-option{flex:1 1 100%}
  header .bar{gap:12px}
  .worker-output{font-size:0.9rem}
}
@media print{
  header,nav,.no-print,.keypad-overlay{display:none!important}
  body{background:#fff;color:#000}
  fieldset{border-color:#000;background:#fff}
  .materials{max-height:none}
}

:root{
  --primary:var(--accent);
  --fg:var(--panel);
}

/* Række for toggle/oversigt */
.material-options{
  display:flex;
  align-items:center;
  margin-bottom:var(--gap);
  margin-left:28px; /* undgå overlap med fold-ikon */
}

.material-options .toggle-selected{
  display:flex;
  align-items:center;
  gap:8px;
  font-size:0.9rem;
}

.material-options input{
  width:18px;
  height:18px;
}

/* Custom checkbox styling til mørkt tema */
.material-options input[type="checkbox"]{
  appearance:none;
  display:inline-grid;
  place-content:center;
  width:18px;
  height:18px;
  border:2px solid var(--accent);
  border-radius:4px;
  background:#2f3238;
  cursor:pointer;
  transition:box-shadow .12s ease,background .12s ease,border-color .12s ease;
}

.material-options input[type="checkbox"]:checked{
  background:var(--primary);
  border-color:var(--primary);
}

.material-options input[type="checkbox"]::after{
  content:"";
  width:10px;
  height:10px;
  transform:scale(0);
  transition:transform .1s ease;
  background:var(--fg);
  mask:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="12" height="10" viewBox="0 0 12 10"><path fill="%23000" d="M4.0 7.2L1.5 4.8 0.4 5.9 4.0 9.5 11.6 1.9 10.5 0.8z"/></svg>') no-repeat center/contain;
}

.material-options input[type="checkbox"]:checked::after{
  transform:scale(1);
}

/* ===== Materials list (scoped) ===== */
.materials-list { display: grid; gap: 10px; }

.materials-list .mat-row{
  display: grid;
  grid-template-columns: 1.4fr 0.6fr 0.6fr 0.8fr; /* Navn, Antal, Pris, Total */
  align-items: center;
  background: #16181d;
  border-radius: 10px;
  padding: 10px 12px;
}

.materials-list .mat-name{
  font-weight: 600; line-height: 1.15; color: #e8eaf0;
}
.materials-list .mat-name .muted{ font-weight: 500; opacity:.8; }

.materials-list .mat-qty,
.materials-list .mat-price,
.materials-list .mat-line{
  width:100%; border:1px solid #2a2f3a; background:#0f1116; color:#e8eaf0;
  padding:10px 12px; border-radius:8px; font-size:15px;
}
.materials-list .mat-qty{ text-align:left; }
.materials-list .mat-price{ opacity:.95; }
.materials-list .mat-line{ text-align:right; font-variant-numeric: tabular-nums; }

.materials-list input:focus{ outline:2px solid #3b82f6; outline-offset:0; }

@media (max-width:480px){
  .materials-list .mat-row{ grid-template-columns:1.2fr .7fr .7fr .8fr; gap:8px; padding:8px 10px; }
  .materials-list .mat-name{ font-size:15px; }
  .materials-list .mat-qty,.materials-list .mat-price,.materials-list .mat-line{ font-size:14px; padding:10px; }
}
